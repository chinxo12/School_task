@model Class

<h2>Create Class</h2>

<div class="row">
    <div class="col-md-6">
        <div class="form-group">
            <label asp-for="ClassId" class="control-label"></label>
            <input asp-for="ClassId" class="form-control" value="@Model.ClassId" readonly/>
            <span asp-validation-for="ClassId" class="text-danger"></span>
        </div>
        <div class="form-group">
            <label asp-for="ClassName" class="control-label"></label>
            <input asp-for="ClassName" class="form-control" value="@Model.ClassName" />
            <span asp-validation-for="ClassName" class="text-danger"></span>
        </div>

        <div class="form-group">
            <label asp-for="Capacity" class="control-label"></label>
            <input type="number" value="@Model.Capacity" asp-for="Capacity" class="form-control" />
            <span asp-validation-for="Capacity" class="text-danger"></span>
        </div>

        <div class="form-group">
                <label asp-for="Faculty.SchoolId" class="control-label"></label>
                <select asp-for="Faculty.SchoolId" class="form-control" >
                    @foreach (var school in (IEnumerable<School>)ViewBag.Schools)
                    {
                      <option value="@school.SchoolId" selected="@((school.SchoolId == Model.Faculty.School.SchoolId) ? "selected" : null)">@school.SchoolName</option>
                    }
                </select>
                <span asp-validation-for="Faculty.SchoolId" class="text-danger"></span>
         </div>
    </div>
    <div class="col-md-6">
        <div class="form-group">
            <label asp-for="FacultyId" class="control-label"></label>
            <select asp-for="FacultyId" class="form-control" id="FacultyId">
                @foreach(var faculty in (IEnumerable<Faculty>)ViewBag.Faculty)
                {
                    <option value="@faculty.FacultyId" selected="@((faculty.FacultyId == Model.Faculty.FacultyId) ? "selected" : null)">@faculty.FacultyName</option>
                }
            </select>

        </div>
    </div>
</div>

<div class="form-group">
    <button type="submit" class="btn btn-primary">Create</button>
</div>

@section scripts {
    <script>
        $(function () {
            // Lấy các trường
            $.ajax({
                type: 'GET',
                url: '@Url.Action("GetSchools")',
                dataType: 'json',
                success: function (data) {
                    $.each(data, function (i, item) {
                        $('#Faculty.SchoolId').append($('<option>', {
                            value: item.schoolId,
                            text: item.schoolName
                        }));
                    });
                }
            });

            // Lấy các khoa của trường khi chọn trường
            $('#Faculty.SchoolId').on('change', function () {
                var schoolId = $(this).val();
                if (schoolId) {
                    $.ajax({
                        type: 'GET',
                        url: '@Url.Action("GetFacultiesBySchoolId")',
                        data: { schoolId: schoolId },
                        dataType: 'json',
                        success: function (data) {
                            var html = '';
                            $.each(data, function (i, item) {
                                html += '<option value="' + item.facultyId + '">' + item.facultyName + '</option>';
                            });
                            $('#FacultyId').html(html);
                        }
                    });
                } else {
                    $('#FacultyId').html('<option value="">--Select--</option>');
                }
            });
        });
    </script>
}
